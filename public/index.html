<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description"
        content="Pelayanan Perizinan Berusaha Terintegrasi Secara Elektronik - Kementerian Investasi dan Hilirisasi/BKPM">
    <meta name="theme-color" content="#0F2E5C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Pelayanan Perizinan Berusaha Terintegrasi Secara Elektronik - Kementerian Investasi dan Hilirisasi/BKPM
    </title>

    <!-- Google Fonts - Montserrat -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Welcome Screen with Slideshow -->
    <section class="survey-step active" id="step-welcome">
        <!-- Slideshow Container -->
        <div class="slideshow-container" id="slideshow">
            <!-- Slide 1 -->
            <div class="slide active" id="slide-1">
                <div class="slide-background"
                    style="background-image: url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=1920&q=80')">
                </div>
                <div class="slide-overlay"></div>
                <div class="slide-content">
                    <img src="https://bkpm.go.id/storage/image/origin/webp/DJxv8PiuraU0FdxuEMAR1svWtdBu0y.webp"
                        alt="Logo BKPM" class="slide-logo">
                    <h1 class="slide-title">KEMENTERIAN INVESTASI<br>DAN HILIRISASI/BKPM</h1>
                    <p class="slide-subtitle">Badan Koordinasi Penanaman Modal Republik Indonesia</p>
                </div>
            </div>

            <!-- Slide 2 -->
            <div class="slide" id="slide-2">
                <div class="slide-background"
                    style="background-image: url('https://images.unsplash.com/photo-1497366216548-37526070297c?w=1920&q=80')">
                </div>
                <div class="slide-overlay"></div>
                <div class="slide-content">
                    <div class="slide-icon">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <h1 class="slide-title">Melayani Dengan Sepenuh Hati</h1>
                    <p class="slide-subtitle">Komitmen kami untuk memberikan pelayanan terbaik</p>
                </div>
            </div>

            <!-- Slide 3 -->
            <div class="slide" id="slide-3">
                <div class="slide-background"
                    style="background-image: url('https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=1920&q=80')">
                </div>
                <div class="slide-overlay"></div>
                <div class="slide-content">
                    <div class="slide-icon pulse-animation">
                        <i class="fas fa-hand-pointer"></i>
                    </div>
                    <h1 class="slide-title">Pelayanan Perizinan Berusaha Terintegrasi Secara Elektronik</h1>
                    <p class="slide-subtitle">Sentuh layar untuk memulai survey</p>
                </div>
            </div>

            <!-- Slide Indicators -->
            <div class="slide-indicators">
                <span class="indicator active" data-slide="1"></span>
                <span class="indicator" data-slide="2"></span>
                <span class="indicator" data-slide="3"></span>
            </div>

            <!-- Touch Overlay -->
            <div class="touch-overlay" id="touchToStart">
                <div class="touch-hint">
                    <i class="fas fa-hand-pointer"></i>
                    <span>Sentuh untuk memulai</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Header (Hidden on welcome, shown during survey) -->
    <header class="header hidden" id="surveyHeader">
        <nav class="navbar">
            <div class="navbar-brand">
                <img src="https://bkpm.go.id/storage/image/origin/webp/DJxv8PiuraU0FdxuEMAR1svWtdBu0y.webp"
                    alt="Logo BKPM" class="logo-header">
            </div>
            <div class="navbar-divider"></div>
            <div class="navbar-text">
                <h1 class="institution-name">KEMENTERIAN INVESTASI / BKPM</h1>
                <p class="institution-subtitle">Pelayanan Perizinan Berusaha Terintegrasi Secara Elektronik</p>
            </div>
        </nav>
        <div class="accent-line"></div>
    </header>

    <!-- Progress Bar -->
    <div class="progress-bar hidden" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <!-- Dynamic Questions Container -->
    <div id="questionsContainer">
        <!-- Questions will be loaded dynamically from API -->
        <section class="survey-step" id="step-loading">
            <div class="step-content">
                <div class="welcome-icon">
                    <i class="fas fa-spinner fa-spin" style="font-size: 80px; color: #0F2E5C;"></i>
                </div>
                <h2 class="question-title">Memuat pertanyaan...</h2>
            </div>
        </section>
    </div>

    <!-- Thank You Screen -->
    <section class="survey-step" id="step-complete">
        <div class="step-content">
            <div class="welcome-icon">
                <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Folded%20Hands.png"
                    alt="Thank You" class="large-emoji bounce-animation">
            </div>
            <h2 class="step-title success">Terima Kasih!</h2>
            <p class="step-description">Penilaian Anda telah berhasil disimpan.<br>Masukan Anda sangat berarti bagi
                kami.</p>
            <div class="countdown-container">
                <p class="countdown-text">Kembali ke halaman awal dalam <span id="countdown">5</span> detik</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer hidden" id="surveyFooter">
        <p>&copy; 2026 Kementerian Investasi dan Hilirisasi/BKPM.<br>Badan Koordinasi Penanaman Modal Republik Indonesia
        </p>
    </footer>

    <!-- JavaScript -->
    <script src="js/app.js"></script>

    <!-- Auto-Fullscreen for Kiosk Mode -->
    <script>
        (function () {
            // Only run on kiosk page (not /admin paths)
            if (window.location.pathname.startsWith('/admin')) {
                return;
            }

            let kioskDomain = '';
            let fullscreenDelay = 3000;
            let isKioskMode = false;

            // Fetch kiosk config from server
            fetch('/api/kiosk-config')
                .then(res => res.json())
                .then(config => {
                    if (!config.success) return;

                    kioskDomain = (config.kioskDomain || '').replace(/^https?:\/\//, '');
                    fullscreenDelay = config.fullscreenDelay || 3000;

                    // Check if current domain matches kiosk domain
                    const currentHost = window.location.hostname;
                    isKioskMode = (currentHost === kioskDomain);

                    if (isKioskMode) {
                        // Show fullscreen prompt overlay
                        showFullscreenPrompt();
                    }
                })
                .catch(err => console.log('Kiosk config not available'));

            function requestFullscreen() {
                const elem = document.documentElement;

                if (document.fullscreenElement) return true; // Already fullscreen

                try {
                    if (elem.requestFullscreen) {
                        elem.requestFullscreen();
                        return true;
                    } else if (elem.webkitRequestFullscreen) {
                        elem.webkitRequestFullscreen();
                        return true;
                    } else if (elem.msRequestFullscreen) {
                        elem.msRequestFullscreen();
                        return true;
                    }
                } catch (e) {
                    console.log('Fullscreen request failed:', e);
                }
                return false;
            }

            function showFullscreenPrompt() {
                // Create prompt overlay
                const overlay = document.createElement('div');
                overlay.id = 'fullscreen-prompt';
                overlay.innerHTML = `
                <div style="
                    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                    background: rgba(15, 46, 92, 0.95); z-index: 99999;
                    display: flex; flex-direction: column; align-items: center; justify-content: center;
                    color: white; font-family: 'Montserrat', sans-serif; text-align: center;
                    cursor: pointer;
                " onclick="enterFullscreen()">
                    <i class="fas fa-expand" style="font-size: 80px; margin-bottom: 30px; animation: pulse 1.5s infinite;"></i>
                    <h2 style="font-size: 2rem; margin-bottom: 15px;">Sentuh untuk Fullscreen</h2>
                    <p style="font-size: 1.1rem; opacity: 0.8;">Tap anywhere to enter fullscreen mode</p>
                </div>
            `;
                document.body.appendChild(overlay);

                // Add animation style
                const style = document.createElement('style');
                style.textContent = `
                @keyframes pulse {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.1); opacity: 0.8; }
                }
            `;
                document.head.appendChild(style);

                // Auto-hide after delay if not clicked
                setTimeout(() => {
                    const prompt = document.getElementById('fullscreen-prompt');
                    if (prompt && !document.fullscreenElement) {
                        prompt.style.opacity = '0.7';
                    }
                }, fullscreenDelay);
            }

            // Global function that can be called from onclick
            window.enterFullscreen = function () {
                if (requestFullscreen()) {
                    const prompt = document.getElementById('fullscreen-prompt');
                    if (prompt) {
                        prompt.remove();
                    }
                }
            };

            // Also handle first touch/click on the page
            document.addEventListener('click', function fullscreenHandler() {
                if (isKioskMode && !document.fullscreenElement) {
                    requestFullscreen();
                    const prompt = document.getElementById('fullscreen-prompt');
                    if (prompt) {
                        prompt.remove();
                    }
                }
                document.removeEventListener('click', fullscreenHandler);
            }, { once: true });

            // Handle fullscreen change
            document.addEventListener('fullscreenchange', () => {
                const prompt = document.getElementById('fullscreen-prompt');
                if (document.fullscreenElement && prompt) {
                    prompt.remove();
                }
            });
        })();
    </script>
</body>

</html>